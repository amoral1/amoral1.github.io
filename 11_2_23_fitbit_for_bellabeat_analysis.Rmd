---
title: "Fitbit data (for Bellabeat research) & analysis"
author: "Anais Morales"
date: "2023-10-28"
output: html_document
---

### Business task
To analyse the fitness data of smart devices to explore possible avenues of growth for Bellabeat; provide recommendations based on findings to the executive team for Bellabeat’s marketing strategy.

#### Guiding questions
What are some trends in smart device usage?
How could these trends apply to Bellabeat customers?
How could these trends help influence Bellabeat marketing strategy?

### About the data
This dataset generated by respondents to a distributed survey via Amazon Mechanical Turk between 03.12.2016-05.12.2016. Thirty eligible Fitbit users consented to the submission of personal tracker data, including minute-level output for physical activity, heart rate, and sleep monitoring. Individual reports can be parsed by export session ID (column A) or timestamp (column B). Variation between output represents use of different types of Fitbit trackers and individual tracking behaviors / preferences.


### Installing R Libraries & packages
``` {r}
library(dplyr)
library(tidyr)
library(skimr)
library(janitor)
library(ggplot2)
library(lubridate)
```
### Process: Data cleaning  & formatting
```{r}
fitbitdaily<- read.csv(file = "/Users/Anais/Downloads/04_2016fitbitspring/dailyActivity_merged.csv")
colnames(fitbitdaily)
```

```{r}
i <- fitbitdaily$Id
a <- fitbitdaily$ActivityDate
n_distinct(i)
```
Verifying 33 unique user-ID's contained in the main dataframe I chose to work with, and that there are 31 days in a month.
```{r}
aparsed <- strptime(a, "%m/%d/%y")
n_distinct(aparsed)
```

Using the hourly intensities data set, I cleaned and formated data that would extropolate dates from just strings, into days of the week and as, dates.
```{r}
intens<- read.csv(file = "/Users/Anais/Downloads/04_2016fitbitspring/hourlyintensities_merged.csv")
intens <- separate(intens, ActivityHour, into=c("date","hour","t"),sep = " ") %>%
  unite("hour", hour, t, sep = ' ' )
intens$date <- mdy(intens$date)
#intens$hour<- (intens$hour)
intens$hour <- format(strptime(intens$hour, "%I:%M:%S %p"), "%H:%M:%S")
intens<- intens%>% mutate(weekdays(date))
intens <- rename(intens, Day="weekdays(date)")
tibble(intens)
```

##### Data visualizations/analysis

```{r}
neo<- data.frame(i, aparsed)
userID_activity<- neo %>%
  mutate(i = i %>% as.numeric %>% as.character) %>%
  ggplot() + geom_point(aes(x=i, y=aparsed, color = i))
userID_activity + theme(axis.text.x = element_blank(),
  axis.ticks = element_blank()) +labs(title="Bellabeat user-activity in a month",
        x ="Unique User", y = "Month/Day/Year") 
```

Using the unique ID's of Fitbit Users, I created a visualization (above) tracing unique users by the activity log of dates during the testing period, i.e. the month of April-Jun 12, 2016. The visualization shows that while most of the users engaged with their Fitbit device throughout the month study, several users did not engage with their device after a certain point, and cannot be accounted for thereafter. 

Significant Observation: On April 16th, 2016 user #4057192912 logged out of their Fitbit and thereby forefeited any usage data to work from, after that day. The data logs show that this drop in unique user ID's was an untypical event in April with this one drop off, however, was more common in May closer to the end of the month mark. Around 9 users total were to drop off of the device usage logs before the full 31 days were up, but some drop offs only missed the month by a day or two. See Takeaway section below for more on this issue. 


```{r}
intens %>%
ggplot() + geom_line(linewidth= 3, position = "stack", aes(x=hour, y=TotalIntensity, color=Day)) +
   theme(axis.text.x = element_text(angle = 90)) +
  labs(title="Max Intensity rates by hours of day during the 7 day week")
```

Using the 24 hour cycle, I used a dataset containing "intensities" by the hour, and mapped the group's total max 'intensities' by days of the week to determine which day(s) the most active users had exerted the most intensity and by how much compared to maxes of other days i.e. how much the most active person per day of the week had exhibited a quantifiable intensity rate, or activity. 

Note: The "TotalIntensity" values have been multiplied by the nearest 100.

```{r}
dsteps<- read.csv(file = "/Users/Anais/Downloads/04_2016fitbitspring/dailySteps_merged.csv")
unique(dsteps$Id)
#verifying data integrity (unique users = 33)
stepdates <- strptime(dsteps$ActivityDay, "%m/%d/%y")
stepsavgsbyid<- dsteps %>%
 group_by(Id) %>% summarize(mean(StepTotal))
#code containing grouped means of StepTotal by ID
colnames(stepsavgsbyid) <- c('Id','AvgSteps') 
#replacing/updating colnames of dataframe
stepsavgsbyid %>%
  mutate(Id = Id %>% as.numeric %>% as.character) %>%
ggplot() + geom_point(aes(x=Id, y=AvgSteps), position = "identity") +
 theme(axis.text.x = element_text(angle = 90)) +
  labs(title="Avg Daily Total Steps by Users")
```

On average, the steps taken daily by Fitbit users during the month stood between 4,000-12,000 steps with a small number of outliers on the lower and higher sides of those values.

### Comments on analysis
From the observations found from the comprehensive dataset where user participation was logged, it would be appropriate to take into account of the margin of error increase, when it comes to the midpoint of the trial, which would likely effect the integrity of the data. Upon calculation, the month of May user (activity) data contains a margin of error of  with the drop off at least 3 users at that point, whereas April started with a ~17% margin of error. There is also no demographic data, which doesn't exclude any potential sample biases. 

### Takeaways & recommendations
While there are some issues with some of the data from this study -- with special consideration given to the month of May, there still remains takeaway recommendations for the direction of Bellabeat's products. 

1. The first recommendation comes from the insight of there being a greater increasing trend of drop-offs from users as the month went on-- one avenue for approaching near total user usage (if the root drop off was lack of morale) would suggest that Bellabeat could implement a positive reinforcement system with UI to encourage the user to be more engaged with their overall health/body through the product, as it will presumably aim to relate to their health as metrics captured by the hardware to their overall will show some comprehensive correlations (such as those found in the analysis above). The point at which a user begins to accrue drop-off or low user activity status, a reminder notification through SNS that pings to other devices about the Bellabeat ecosystem and product could help with the user's intial goals for using the hardware/product line. 

2. Addressing intensities of fitbit usage throughout the week: the weekday exhibiting the highest intensity rate was Fridays followed by Mondays, throughout most hours of the day, and the weekends reflect some of the lowest intensity rates even at the most significant data points. I would suggest some lifestyle organizer/planner to be incorporated into Bellabeat's product line -- something that can take into account distributing intensity rates throughout the week so that the weekends can be an added rest period, as opposed to being the only rest period. The basal metabolic rate (BMR), is the baseline caloric burning off of calories the body account for as a metric i.e. baseline "intensities" exerted from the body without active particiation (or energy burned at rest/non-activity). Whereas, total daily energy expenditure (TDEE) takes into consideration caloric lost from both resting and exercise. The rise of cortisol levels, the stress hormone levels, can also contribute to intensity rates, assuming this value accounts for all undergone intensities (see appendixes 1 and 2) according to dietians, in relation to metabolic issues and insulin resistance causing lethargy, and can defeat the intended goals of someone whose intent is to lose weight. More stress on any given day of the week can potentially harm health and fitness. An app or feature that can help offload stress (at the beginnings and ends of the week) by dividing intensities throughout the week could be implemented, and benefit the user. However, it should be understood that further testing would be needed to determine specifically on the character that "intensity rates" have taken, the presumption here is that these high rates can correlate with cortisol (refer to appendix) -- but more qualitative tests can be done or more surveying can be done on the participant's lifestyle during a new trial. 

3. My final recommendations act as an addendum to some of the previous in terms of user interface ina-app notifications based on the tracking of total steps of the Fitbit users. There are some exceptions to the trend, but in general, a majority of the users seem to average between 4,000-12,000 steps by day while under this testing period of a month in Spring of 2016. With fitness the general desire is to exercise the muscle, or in the case of weightloss, to burn calories (refer to appendix). So, depending on the user's goal, Bellabeat can implement some metric goal for daily total steps as a quota -- to help the user regulate and mediate their fitness goals in the most accommodating ways, for those on the lower end of avg. daily step rates.  

### Appendix
1. “Best TDEE Calculator: Calculate Your Total Daily Energy Expenditure.” Fitness Calculators. https://tdeecalculator.org/. 
2. Mancella, Gabrielle. “How Too Much Stress Can Cause Weight Gain (and What to Do about It).” February 12, 2020. https://www.orlandohealth.com/content-hub/how-too-much-stress-can-cause-weight-gain-and-what-to-do-about-it.